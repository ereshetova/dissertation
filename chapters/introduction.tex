\begin{quoting}
\todo[inline]{Find a nice quote here}
\end{quoting}

\section{Motivation}

Nowadays we are surrounded by an enormous amount of various mobile and embedded devices on a daily basis: from smartphones and tablets to smart watches and smart glasses, from home entertainment and video surveillance systems to smart home appliances, from in-vehicle infotainment to flying drones. More and more functionality that used to be carried out manually by humans is automated with interconnected devices. Many recent attacks have shown that these devices and the associated infrastructure is very vulnerable to different types of attacks, such as leak of private or confidential data, violation of privileges, denial-of-service and many others. 

The long history of information and device protection in PC world have developed a set of techniques in order to withstand these attacks. The term "\textit{platform security}" is used to denote the set of security mechanisms implemented in a device against its pre-defined threat model. These mechanisms might provide run-time and offline confidentiality and integrity of devices and users data, prevent privilege escalation should a particular part of device become compromised, implement an anti-virus protection against malware, etc. However, the platform security architectures that have been originally developed for the relatively closed server and workstation systems are not well-suited for the mobile or embedded devices. 

Mobile devices, such as smartphones, were the first new wave of devices that required an entirely different approach for designing platform security due to their open nature, i.e. ability for the user to install third-party applications, as well as a wide range of different user types (from very inexperienced ones to software developer hobbyists). A designer of the platform security solution could not anymore assume that a user of a device is an experienced system administrator understanding a wide range of security risks and access control policy enforcing mechanisms. A mobile device user not only lacks this knowledge, but also in many cases is explicitly not willing to be involved in any such matters or decisions: he or she just wants to accomplish a simple task of sending a message or installing a popular game. The situation gets even more severe as we start looking into various in-vehicle infotainment systems where the user-driven open entertainment system might be partly co-located with the car instrument cluster with very strict safety requirements and regulations. 

The design and implementation of any platform security architecture varies greatly based on target environment, use cases, device capabilities, cost factors and prioritized set of risks and threats. A lot of prior research both in the academia and the industry examines this problem from all different angles and aspects, but the practice shows that achieving a good balance is still hard: many attacks are published regularly that find holes or abuse different platform security mechanisms and lead to severe implications on user's privacy, overall safety, denial of service and others. The producers of the devices, OEMs, in turn are facing heavy pressure to deliver fast (due to the very competitive pace of modern industry) while balancing with the security requirements of various involved stakeholders from the ordinary users to various legislationâ€™s. Finding the right balance between the appropriate level of security, development effort and the end-user usability represents the main challenge that any platform security researcher or architect faces on a daily basis. Therefore the success of the developed platform security architectures depends on how well this challenge is addressed.   

\section{Objectives}
\label{sec:Objectives}

The goal of this thesis is to look at different practical platform security challenges that modern mobile and embedded systems are facing today and will face in the near future. The thesis attempts to develop mechanisms and techniques that can help OEMs to deliver devices with the right balance of security, practical deployability and usability. In order to do this, we want to make sure that whenever a certain mechanism or solution is proposed, it satisfies the following requirements:

\begin{enumerate}
	\item \textbf{Security}. The proposed mechanism must provide sufficient security level for the given set of use cases. There is no aim of reaching a perfect security if it makes the solution too unpractical for deployment or fails to satisfy the below non-security-related requirements.      
	\item \textbf{Practical deployability}. A mechanism or technique that is hard to deploy in practice is of little use in the industry. Instead the end goal of each proposed measure should be its integration and practical use in the respective area of interest. While it is not always possible to achieve this goal, it must be shown that the proposed solution satisfies all the standard deployability requirements of the field, such as performance, development life cycle, scalability, etc.  
	\item \textbf{Usability}.	The solution must be easy to use and understand for an ordinary user of the system. The latter might not necessary mean the end user of a device, but can also be an application developer, an access control policy writer, a kernel subsystem maintainer etc. These users usually have very different knowledge base and backgrounds, but in order for a solution to be taken into use and used correctly, it is essential to meet the usability requirements of all its intended users. 
\end{enumerate}

\section{Outline}

This dissertation is based on six original publications which are grouped into three main areas, all around various aspects of platform security. An additional Publication VII, greatly based on Publication I, is also referred in this thesis. 

The foundation of Chapter~\ref{sec:plat-sec} is a generic platform security model for mobile devices defined in Publications I and VII. Through the survey of six different platform security architectures for the most common mobile operating systems, they show that despite the differences in the implementations, all of these architectures follow the same design patterns and principles. The same trend is also visible for embedded devices, but with a major focus on the mainline Linux kernel security mechanisms due to ease of maintenance and cost reduction. Chapter~\ref{sec:plat-sec} also presents a generic platform security model for an embedded device based on the mainline Linux kernel security components and mechanisms and explains their high-level purpose. The chapter ends with a motivation for selecting the two specific focus areas for this dissertation, namely \textit{process and application isolation mechanisms} and \textit{OS kernel hardening}. The former area, despite being researched for decades, still presents one of the biggest practical challenges
for security architects due to the many different mechanisms present in the mainline Linux kernel and the almost unlimited ways in which these mechanisms can be configured. The latter area, that has recently gained a lot of attention in the Linux security community, is of utmost importance, since if OS kernel is compromised as a result of a successful exploit attack, all its security mechanisms are rendered ineffective.

Chapter~\ref{sec:ac-policies} focuses on the process and application isolation methods employed by modern operating systems and encompasses Publications II, III and IV. Publication II studies the mandatory access control mechanism, SEAndroid~\cite{smalley12}, employed by the Android operating system at the moment when OEMs had to go through the challenge of learning how to create their access control policies. The publication shows the difficulties that they were facing when trying to create the correct policy for their newly added components, as well as the most common pitfalls. It also presents a list of practical tools that can help OEMs, developers and security researchers to create better access control policies, including one such tool, \textit{SEAL}. Publication III presents another tool, \textit{SELint}, that was specifically developed to smoothly integrate into the OEMs development workflow. Next, Chapter~\ref{sec:ac-policies} takes a different angle and, using Publication IV, examines a relatively new popular method for process isolation that is based on the OS-level virtualization. While this technique is prominent and has been recently greatly improved, there are still gaps that prevent its usage as a full alternative to traditional mandatory access control mechanisms.

Chapter~\ref{sec:kernel-hardening} considers a very different challenge: the need to be able to have the core of an operating system, OS kernel, secured against various attacks. This is a very important area, because the OS kernel is becoming a more and more attractive target for attackers due to both its high privileges and recent tightening of the userspace security. Publication V shows a powerful attack against a very commonly used Linux kernel subsystem, Just-In-Time (JIT) Compiler for Berkeley Packet Filter (BPF), which served as a motivator for a stricter hardening of this subsystem. In turn Publication VI proposes two methods for addressing the Linux Kernel OS memory safety and therefore preventing common Linux OS kernel vulnerabilities, such as various buffer overflows and use-after-frees. 

Finally, Chapter~\ref{sec:discussion} presents an overall evaluation of the methods proposed in this dissertation against the objectives set in Section~\ref{sec:Objectives} and attempts to give an overall outlook on future mobile and platform security challenges. 

